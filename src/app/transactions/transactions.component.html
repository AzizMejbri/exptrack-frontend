<!-- transactions.component.html -->
<div class="transactions-container">
  <div class="transactions-header">
    <h1>Transaction Center</h1>
    <button class="btn-primary" (click)="openAddModal()">+ Add Transaction</button>
  </div>

  <!-- Filters -->
  <div class="filters-section">
    <div class="filter-group">
      <input type="text" placeholder="Search transactions..." [(ngModel)]="searchTerm" (input)="applyFilters()" class="search-input">
    </div>

    <div class="filter-group">
      <select [(ngModel)]="selectedType" (change)="applyFilters()" class="filter-select">
        <option value="all">All Types</option>
        <option value="expense">Expenses</option>
        <option value="revenue">Revenue</option>
      </select>
    </div>

    <div class="filter-group">
      <select [(ngModel)]="selectedCategory" (change)="applyFilters()" class="filter-select">
        <option value="all">All Categories</option>
        <option *ngFor="let category of getCategories()" [value]="category">{{ category }}</option>
      </select>
    </div>

    <div class="filter-group">
      <input type="date" [(ngModel)]="dateRange.start" (change)="applyFilters()" placeholder="Start date" class="date-input">
      <input type="date" [(ngModel)]="dateRange.end" (change)="applyFilters()" placeholder="End date" class="date-input">
    </div>
  </div>

  <!-- Transactions List -->
  <div class="transactions-list">
    <div *ngFor="let transaction of filteredTransactions" class="transaction-card">
      <div class="transaction-icon" [class.expense]="transaction.type === 'expense'" [class.revenue]="transaction.type === 'revenue'">
        {{ transaction.type === 'expense' ? '‚Üì' : '‚Üë' }}
      </div>

      <div class="transaction-details">
        <div class="transaction-main">
          <span class="description">{{ transaction.description }}</span>
          <span class="category">{{ transaction.category }}</span>
        </div>
        <div class="transaction-meta">
          <span class="date">{{ formatDate(transaction.createdAt) }}</span>
        </div>
      </div>

      <div class="transaction-amount" [class.expense]="transaction.type === 'expense'" [class.revenue]="transaction.type === 'revenue'">
        {{ transaction.type === 'expense' ? '-' : '+' }}{{ formatCurrency(transaction.amount) }}
      </div>

      <div class="transaction-actions">
        <button class="btn-edit" (click)="editTransaction(transaction)" title="Edit transaction">‚úèÔ∏è</button>
        <button class="btn-delete" (click)="deleteTransaction(transaction)" title="Delete transaction">üóëÔ∏è</button>
      </div>
    </div>

    <div *ngIf="filteredTransactions.length === 0" class="empty-state">
      <p>No transactions found. <a (click)="openAddModal()" class="add-link">Add your first transaction!</a></p>
    </div>
  </div>

  <!-- Add Transaction Modal -->
  <div *ngIf="showAddModal" class="modal-overlay" (click)="closeAddModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Add New Transaction</h2>
        <button class="close-btn" (click)="closeAddModal()">√ó</button>
      </div>

      <form (ngSubmit)="addTransaction()" class="transaction-form">
        <div class="form-group">
          <label>Type</label>
          <select [(ngModel)]="newTransaction.type" name="type" class="form-select">
            <option value="expense">Expense</option>
            <option value="revenue">Revenue</option>
          </select>
        </div>

        <div class="form-group">
          <label>Amount</label>
          <input type="number" [(ngModel)]="newTransaction.amount" name="amount" class="form-input" min="0" step="0.01" required>
        </div>

        <div class="form-group">
          <label>Category</label>
          <select [(ngModel)]="newTransaction.category" name="category" class="form-select" required>
            <option value="">Select a category</option>
            <option *ngFor="let category of getCategories()" [value]="category">{{ category }}</option>
          </select>
        </div>

        <div class="form-group">
          <label>Description</label>
          <input type="text" [(ngModel)]="newTransaction.description" name="description" class="form-input" required>
        </div>

        <div class="form-group">
          <label>Date</label>
          <input type="date" [(ngModel)]="newTransaction.createdAt" name="date" class="form-input" required>
        </div>

        <div class="form-actions">
          <button type="button" class="btn-secondary" (click)="closeAddModal()">Cancel</button>
          <button type="submit" class="btn-primary">Add Transaction</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Edit Transaction Modal -->
  <div *ngIf="showEditModal" class="modal-overlay" (click)="closeEditModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Edit Transaction</h2>
        <button class="close-btn" (click)="closeEditModal()">√ó</button>
      </div>

      <form (ngSubmit)="updateTransaction(); $event.preventDefault()" class="transaction-form">
        <div class="form-group">
          <label>Type</label>
          <select [(ngModel)]="editingTransaction.type" name="editType" class="form-select" required>
            <option value="expense">Expense</option>
            <option value="revenue">Revenue</option>
          </select>
        </div>

        <div class="form-group">
          <label>Amount</label>
          <input type="number" [(ngModel)]="editingTransaction.amount" name="editAmount" class="form-input" min="0" step="0.01" required>
        </div>

        <div class="form-group">
          <label>Category</label>
          <select [(ngModel)]="editingTransaction.category" name="editCategory" class="form-select" required>
            <option value="">Select a category</option>
            <option *ngFor="let category of getEditCategories()" [value]="category">{{ category }}</option>
          </select>
        </div>

        <div class="form-group">
          <label>Description</label>
          <input type="text" [(ngModel)]="editingTransaction.description" name="editDescription" class="form-input" required>
        </div>

        <div class="form-actions">
          <button type="button" class="btn-secondary" (click)="closeEditModal()">Cancel</button>
          <button type="submit" class="btn-primary">Update Transaction</button>
        </div>
      </form>
    </div>
  </div>
</div>
